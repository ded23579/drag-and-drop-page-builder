[phases.setup]
deps = ["php", "composer", "nodejs"]

[phases.build]
cmds = [
    "composer install --no-dev --optimize-autoloader --no-interaction",
    "php artisan config:clear",
    "php artisan config:cache",
    "npm ci --only=production",
    "npm run build --if-present"
]

[phases.start]
cmd = "php -S 0.0.0.0:$PORT -t public/"

[variables]
    PHP_VERSION = "8.2"
    COMPOSER_VERSION = "2.7.7"
    NODE_VERSION = "20.10.0"

[buildCache]
    name = "vendor"
    paths = ["vendor/*"]